write_system_prompt: |
  You are an ambitious AI PhD student who is looking to publish a paper that will contribute significantly to the field.
  You have already figured out the research idea and the experiments you want to run.
  Write pure LaTeX, not Markdown.
  Use only citations already present in references.bib, and place each \cite{{}} or \citet{{}} next to the claim it supports.
  Keep equations readable, break long expressions with align/multline/split, and use proper LaTeX environments for tables and algorithms.
  Follow loaded writer skills for detailed citation, LaTeX, and paper-writing methodology.


write_system_prompt_related_work:
  You are an ambitious AI PhD student who is looking to publish a paper that will contribute significantly to the field.
  You have already figured out the research idea and the experiments you want to run.
  Now, you need to write the paper draft based on the template provided in `latex/template.tex`.

section_tips:
  Abstract: |
    - One paragraph only.
    - Cover problem, importance, challenge, method, and key result.
    - Keep it concise and evidence-based.

  Introduction: |
    - Use 5 paragraphs: problem, importance, difficulty, prior gap, and contribution/results.
    - Move from broad context to the exact research gap.
    - End with a clear statement of what this paper does.

  Related_Work: |
    - Write 3 thematic paragraphs, at most 4.
    - Compare and contrast by assumptions, methods, or applicability.
    - Do not merely summarize papers one by one.

  Method: |
    - Define the problem and notation first.
    - Explain the core modules, equations, and design rationale.
    - Focus on the novel mechanism, not implementation trivia.
    - Exclude experimental setup details.

  Experimental_Setup: |
    - Describe dataset, splits, preprocessing, metrics, and key hyperparameters.
    - Keep hardware claims conservative and grounded in available evidence.
    - Do not include results here.

  Results: |
    - Lead each paragraph with the main takeaway.
    - Report concrete numbers before interpretation.
    - Explain why the observed pattern matters.

  Discussion: |
    - Anticipate reviewer challenges explicitly.
    - Use 3-4 question-style subsections with evidence-based answers.
    - Be specific and quantitative.

  Conclusion: |
    - One short paragraph only.
    - Structure: problem, contribution, findings, future direction.
    - Do not repeat detailed discussion.

error_list: |
  - Unenclosed math symbols
  - Only reference figures that exist in our directory
  - LaTeX syntax errors
  - Numerical results that do not come from explicit experiments and logs
  - Repeatedly defined figure labels
  - References to papers that are not in the .bib file, DO NOT ADD ANY NEW CITATIONS!
  - Unnecessary verbosity or repetition, unclear text
  - Results or insights in the `notes.txt` that have not yet need included
  - Any relevant figures that have not yet been included in the text
  - Closing any \\begin{{figure}} with a \\end{{figure}} and \\begin{{table}} with a \\end{{table}}, etc.
  - Duplicate headers, e.g. duplicated \\section{{Introduction}} or \\end{{document}}
  - Unescaped symbols, e.g. shakespeare_char should be shakespeare\\_char in text
  - Incorrect closing of environments, e.g. </end{{figure}}> instead of \\end{{figure}}
  - **Equations that exceed line width** - use \\begin{{align}} or \\begin{{multline}} for long equations

multi_round_refinement_prompt: |
  You are refining the {section} section (Round {round_num}/{total_rounds}).

  **Current Focus for This Round**: {focus}

  **Current Section Content**:
  {section_content}

  **Section Guidelines**:
  {section_tips}

  **SPECIAL INSTRUCTION for Conclusion**: If this is the Conclusion section, you MUST keep it as ONE single paragraph (~100-150 words). Do NOT expand it. Do NOT add multiple paragraphs.

  **Full Paper Context** (all other sections for coherence check):
  {other_sections_context}

  **Refinement Instructions**:
  1. {method_specific_instruction}
  2. Improve mathematical notation and formalism
  3. Add design rationale for key choices
  4. **CRITICAL**: Read the Full Paper Context above to ensure your refined section is coherent with other sections
  5. Ensure terminology, notation, and narrative flow are consistent across the paper

  **CRITICAL - CITATION PRESERVATION**:
  6. **PRESERVE ALL EXISTING \\cite{{}} COMMANDS unless their supporting content is removed**
  7. If you keep content, you MUST keep its citations
  8. If you remove redundant/contradictory content, you may remove its citations too
  9. Do NOT arbitrarily relocate citations to unrelated sentences
  10. If you add new content, add appropriate NEW citations to support it
  11. Aim to maintain or increase the total number of citations (unless removing redundant sections)

  Apply loaded writer skills for detailed citation placement and LaTeX hygiene.

  **Common Errors to Avoid**:
  {error_list}

  Output the refined section directly (no explanations).

add_new_citations_prompt: |
  You are adding NEW citations to the {section} section.

  **Current section content**:
  {section_content}

  **NEW papers to cite** (cite ALL of these):
  {paper_context}

  **CRITICAL INSTRUCTIONS**:
  1. Each paper is formatted as: [CITE_KEY: bibtex_key] Title (authors, venue, year)
  2. You MUST extract the bibtex_key from [CITE_KEY: bibtex_key] and use it for citations
  3. Add citations using \\cite{{bibtex_key}} format (use EXACTLY the bibtex_key shown)
  4. Cite ALL {num_papers} new papers provided above
  5. Keep ALL existing citations and content intact
  6. Add new citations in contextually appropriate places
  7. If needed, expand 1-2 sentences to naturally incorporate citations
  8. Do NOT remove or change existing citations
  9. Example: If you see [CITE_KEY: Smith2024], cite it as \\cite{{Smith2024}}

  **MEANINGFUL CITATION PLACEMENT**:
  - Each citation MUST directly support the specific claim or statement in that sentence
  - Place citations immediately after the claim they support (e.g., "Recent work shows improvement~\\cite{{Smith2024}}.")
  - Read each paper's abstract to understand what it claims, then cite it where that claim is relevant
  - Do NOT add citations randomly or at the end of unrelated sentences
  - If you need to cite a paper but no suitable sentence exists, add a new sentence that makes a claim the paper supports
  - Example: If a paper proposes a new architecture, cite it when discussing that architecture, NOT when discussing datasets

  Output the enhanced section with all citations.

citation_system_prompt: |
  You are an academic writing assistant helping add and embed citation coverage in a research paper.

  Your role:
  - When asked to suggest citations, return only real, published academic paper titles that are highly relevant to the given content.
  - When asked to embed citations, you will be provided with papers in the format: [CITE_KEY: bibtex_key] Paper Title (authors, venue, year)
  - You MUST extract and use the EXACT bibtex_key from [CITE_KEY: bibtex_key] when inserting `\cite{{bibtex_key}}` commands.
  - For example, if you see [CITE_KEY: smith2023nlp] Natural Language Processing..., you must write \cite{{smith2023nlp}}
  - NEVER invent citation keys - only use the keys explicitly provided in [CITE_KEY: ...]

  **CRITICAL - MEANINGFUL CITATION PLACEMENT**:
  - Each citation MUST support a specific claim, method, finding, or statement in that sentence
  - Citations should be placed immediately after the claim they support
  - Do NOT randomly insert citations without clear relevance to the sentence content
  - If a paper is not directly relevant to a specific claim, do NOT force it into that sentence
  - Each citation should have a clear purpose: supporting a claim, referencing a method, citing prior work, etc.

  Do not invent or fabricate any citations.
  Do not output BibTeX, author names, or publication details.

  **CRITICAL - LaTeX Format Only (NO Markdown)**:
  - Use \textbf{{text}} for bold, NOT **text**
  - Use \textit{{text}} for italic, NOT *text*
  - Use \texttt{{text}} for code/monospace, NOT `text`
  Be thorough - missing citations is not acceptable
  Always follow the expected output format (JSON array or updated LaTeX content), with no extra commentary or explanation.

citation_search_query_prompt: |
  You will generate search queries to find relevant papers for citation in the {section} section.

  **CONTEXT**:
  - Idea (single string):
    {idea}
  - Section Content Snippet:
    {snippet}

  **YOUR TASK**: Read the IDEA and SNIPPET above and extract 2-3 SPECIFIC technical terms FROM THEM to create 6-10 search queries.

  **CRITICAL STEP-BY-STEP**:
  1. READ the idea and the section snippet carefully
  2. IDENTIFY specific techniques/algorithms/models (e.g., "graph attention network", "knowledge distillation", "BERT")
  3. IDENTIFY the task/application when present (e.g., "link prediction", "question answering")
  4. CREATE queries as: "specific_technique AND specific_task" (if task is present), otherwise combine 2-3 specific techniques
  5. DO NOT use generic terms; use only concrete technical terminology

  **TYPES OF SPECIFIC TERMS TO EXTRACT**:
  ✅ Specific models: "BERT", "GPT-4", "T5", "ResNet"
  ✅ Specific architectures: "graph attention network", "encoder-decoder"
  ✅ Specific techniques: "knowledge distillation", "contrastive learning", "adversarial training"
  ✅ Specific mechanisms: "multi-head attention", "cross-attention", "tree-based reasoning"
  ✅ Specific tasks: "question answering", "sentiment analysis", "link prediction"
  ✅ Specific datasets/benchmarks: "SQuAD", "GLUE", "ImageNet"

  **WHAT TO AVOID**:
  ❌ "deep learning", "machine learning", "AI"
  ❌ "neural networks" (specify which type)
  ❌ Domain-only terms: "NLP", "CV"
  ❌ Vague phrases: "improve performance", "state-of-the-art"

  **FORMAT EXAMPLES** (structure only):
  - If idea/snippet mentions "BERT for question answering" → "BERT AND question answering"
  - If mentions "graph attention on citation networks" → "graph attention network AND citation network"
  - If discusses "knowledge distillation for language models" → "knowledge distillation AND language model"

  **OUTPUT FORMAT**:
  Return ONLY a JSON array of 6-10 query strings. No extra text, no markdown, no explanations.

  Example:
  [
    "graph attention network AND link prediction",
    "knowledge distillation AND language model",
    "multi-head attention AND machine translation"
  ]

abstract_prompt: |
  You are writing the Abstract section of a top-tier AI research paper.
  Some tips are provided below:
  {abstract_tips}

  Here is the research idea that the paper is based on (single string):
  {idea}

  IMPORTANT: The full paper has already been written. Below is the complete content of all sections.
  Your task is to write an abstract that accurately summarizes what was actually written in the paper,
  not just the initial idea. Pay attention to the actual methods used, experiments conducted, and results obtained.

  === FULL PAPER CONTENT ===
  {full_paper_content}
  === END OF PAPER CONTENT ===

  Based on the full paper content above, write a concise abstract that:
  1. States the problem addressed in the paper
  2. Explains why it's important and challenging
  3. Describes the proposed solution/method
  4. Summarizes the key experiments and results
  5. Highlights the main contributions

  The output must be pure LaTeX and enclosed with \begin{{abstract}} ... \end{{abstract}}.
  Be sure to first name the file and use *SEARCH/REPLACE* blocks to perform these edits.


section_prompt:
  Introduction: |
    You are writing the Introduction section of a top-tier AI research paper.
    Follow loaded writer skills for introduction-writing methodology.

    Some tips are provided below:
    {section_tips}

    **THE RESEARCH IDEA YOU ARE WRITING ABOUT**:
    {idea}

    **IMPORTANT**: You have access to previously written sections (if any). Make sure your Introduction builds upon and expands the Abstract naturally, while incorporating insights from the Related Work to position your contribution in the broader research context.

    **Previous sections (Abstract, Related Work, etc.):**
    {previous_context}

    **Your goal is to write a compelling, multi-paragraph introduction** that logically develops the background, motivation, and research gap. The tone should be formal, informative, and engaging.

    Be sure to use \cite or \citet where relevant, referring to the works provided in the file.
    Do not cite anything that is not already in `references.bib`. Do not add any new entries to this.

    **Citation Usage**: Each citation must support a specific claim in that sentence (e.g., cite prior work when stating what has been done before, cite foundational work when introducing concepts).

    Use at **5 paragraphs**, and aim for **250–300 words**.

    Keep the experimental results (figures and tables) only in the Results section, and make sure that any captions are filled in.
    In this pass, do not reference anything in later sections of the paper.

    Begin with:
    \section{{Introduction}}
    ...

  Method: |
    Please fill in the Method section of the writeup. The Method section should **clearly define the approach taken in this study**, ensuring that readers can understand and, if needed, replicate the implementation.

    **THE RESEARCH IDEA (Focus on the "Proposed Approach" section)**:
    {idea}

    **AVAILABLE CODE** (Reference for implementation details if needed):
    ```python
    {code}
    ```
    Follow loaded writer skills for method-writing methodology.

    Some tips are provided below:
    {section_tips}

    **IMPORTANT GUIDELINES**:
    1. **CRITICAL**: Base your Method section on the **Proposed Approach** described above - this is the core methodology you must explain in detail
    2. Structure your Method section with multiple \paragraph{{}} blocks (minimum 3-5)
    3. Start with formal problem definition using mathematical notation
    4. Include equations for key transformations (use \begin{{align}}...\end{{align}} for long equation)
    5. For each major component, explain BOTH what it does AND why (design rationale)
    6. Build upon the motivation from previous sections while introducing technical details
    7. Ensure the Method section fully elaborates on the approach outlined in the original idea

    **IMPORTANT**: You have access to the previous sections that were already written. Make sure your Method section builds upon the motivation and problem definition established earlier, while introducing your technical approach clearly and coherently.

    **Previous content:**
    {previous_context}

    Be sure to use \cite or \citet where relevant, referring to the works provided in the file.
    Do not cite anything that is not already in `references.bib`. Do not add any new entries to this.

    **Citation Usage**: Each citation must support a specific claim in that sentence (e.g., cite papers when referencing their methods, when building upon their techniques, or when comparing approaches).

    Keep the experimental results (figures and tables) only in the Results section, and make sure that any captions are filled in. DO NOT SAY CONCRETE EXPERIMENTAL SETUP IN METHOD SECTION. JUST DESCRIBE THE ALGORITHM AND THE MAJOR COMPONENT OF YOUR METHOD.
    In this pass, do not reference anything in later sections of the paper.

    Begin with:
    \section{{Method}}
    ...

  Experimental_Setup: |
    Please fill in the Experimental Setup section of the writeup. This section should **clearly document how the experiments were conducted** so that they can be replicated by other researchers.

    **THE RESEARCH IDEA (Focus on "Proposed Approach" and "Experiment Plan" sections)**:
    {idea}

    **AVAILABLE CODE** (Reference for implementation details):
    ```python
    {code}
    ```
    Follow loaded writer skills for experimental-writeup methodology when relevant.

    Some tips are provided below:
    {section_tips}

    **IMPORTANT**: You have access to the previous sections that were already written. Make sure your Experimental Setup section clearly connects to the method introduced earlier and provides specific implementation details that follow logically from the proposed approach.

    **Previous content:**
    {previous_context}

    Be sure to use \cite or \citet where relevant, referring to the works provided in the file.
    Do not cite anything that is not already in `references.bib`. Do not add any new entries to this.

    **Citation Usage**: Each citation must support a specific claim in that sentence (e.g., cite datasets when referencing them, cite papers when using their evaluation metrics or experimental protocols).

    Keep the experimental results (figures and tables) only in the Results section, and make sure that any captions are filled in.
    In this pass, do not reference anything in later sections of the paper.

    Begin with:
    \section{{Experimental Setup}}
    ...

  Discussion: |
    Please fill in the Discussion section of the writeup. Follow the instructions carefully.

    **THE RESEARCH IDEA (Focus on "Proposed Approach" to explain WHY it works)**:
    {idea}

    **EXPERIMENTAL RESULTS** (Concrete numbers to reference as evidence):
    {experiment_results}

    **BASELINE RESULTS** (For comparison):
    {baseline_results}
    Follow loaded writer skills for discussion methodology.

    **CRITICAL INSTRUCTIONS FOR YOUR DISCUSSION**:

    You MUST structure your Discussion to **anticipate and address reviewer challenges**. Your goal is to make the paper more convincing by proactively defending against potential attacks.

    **Required Structure**:
    1. Write an opening paragraph that outlines what challenges you will address (like the example above)
    2. Create 3-4 subsections, each formatted as:
       - \subsection*{{Q#: [Question that challenges your method's validity]?}}
       - 1-3 paragraphs with concrete evidence (cite specific experiments, figures, tables, numbers)

    **Tips for Strong Defense**:
    - Be specific with numbers: "improves by 15.3% (p<0.01)" not "improves significantly"
    - Reference concrete evidence: "as shown in Table X" or "Figure Y demonstrates"
    - Compare to multiple baselines or settings when possible
    - Admit minor limitations honestly, but explain why they don't invalidate the method

    Some additional tips for writing a strong Discussion section:
    {section_tips}


    **IMPORTANT**: You have access to all previous sections that were already written. Make sure your Discussion section synthesizes the results with the method, experimental setup, and broader context established earlier. Analyze the implications of your findings in relation to the original problem and methodology.

    **Previous content:**
    {previous_context}

    Be sure to use \cite or \citet where relevant, referring to the works provided in the file.
    Do not cite anything that is not already in `references.bib`. Do not add any new entries to this.

    **Citation Usage**: Each citation must support a specific claim in that sentence (e.g., cite papers when comparing your results to theirs, when discussing similar findings, or when referencing related analyses).

    Keep the experimental results (figures and tables) only in the Results section, and make sure that any captions are filled in.
    In this pass, do not reference anything in later sections of the paper.

    Begin with:
    \section{{Discussion}}
    ...

  Results: |
    Please fill in the Results section of the research paper. Follow the instructions carefully.

    **THE RESEARCH IDEA** (For context on what was evaluated):
    {idea}

    **EXPERIMENTAL RESULTS** (Concrete numbers to report):
    {experiment_results}

    **BASELINE RESULTS** (For comparison):
    {baseline_results}
    Follow loaded writer skills for results-writing methodology.

    Some tips for writing a strong Results section:
    {section_tips}

    **IMPORTANT**: You have access to the previous sections that were already written. Make sure your Results section clearly connects the experimental outcomes to the method and setup described earlier. Reference the experimental design and evaluation criteria established in previous sections.

    **Previous content:**
    {previous_context}

    **Citation Usage**: If citing prior work (e.g., for baselines or comparisons), each citation must support a specific claim in that sentence (e.g., cite papers when reporting their baseline results or when comparing performance).

    Ensure that all results presented have been obtained and are recorded in the logs.
    In this pass, do not reference anything in later sections of the paper.

    Begin with:
    \section{{Results}}
    ...

  Conclusion: |
    Please write a **BRIEF and CONCISE** Conclusion section as **ONE single paragraph** (~100-150 words).

    **THE RESEARCH IDEA** (For high-level summary):
    {idea}

    {section_tips}

    **Previous content:**
    {previous_context}

    **CRITICAL REQUIREMENTS**:
    1. Write ONLY ONE paragraph (no paragraph breaks)
    2. Structure: Problem → Contribution → Key findings → Future direction
    3. Total length: 4-6 sentences maximum (~100-150 words)
    4. NO new information, NO detailed explanations
    5. Do NOT repeat content from Discussion or Results in detail
    6. Keep it concise and high-level

    Begin with:
    \section{{Conclusion}}

    [Write one paragraph here]



related_work_prompt: |
  Please write the Related Work section of the research paper. Follow the instructions and structure strictly.

  **CRITICAL STRUCTURE REQUIREMENT**:
  - Write **3 paragraphs** (at most 4 paragraphs)
  - Each paragraph should focus on a distinct category or theme of related work
  - Use \paragraph{{Category Name}} to start each paragraph
  - Group related papers together within each paragraph

  Some tips for writing a strong Related Work section:

  {related_work_tips}

  - Academic siblings of our work, i.e. alternative attempts in literature at trying to solve the same problem.
  - Goal is to “Compare and contrast” - how does their approach differ in either assumptions or method? If their method is applicable to our Problem Setting I expect a comparison in the experimental section. If not, there needs to be a clear statement why a given method is not applicable.
  - Note: Just describing what another paper is doing is not enough. We need to compare and contrast.

  The motivation for this study is: {experiment}

  You must ground your discussion using **only** the following pre-selected relevant papers.
  Each paper is formatted as: **[bibtex_key]** Paper Title (authors, venue, year)

  CRITICAL: When citing a paper, you MUST use the bibtex_key shown in square brackets [].
  For example, if you see **[gao2019graphnas]** GraphNAS..., you must write \cite{{gao2019graphnas}}

  Use LaTeX `\cite{{...}}` format **strictly** to reference these works. Do not add any new citations.
  You must cite **all** of the following papers at least once using \cite{{...}}.
  Do not leave out any item from the list.

  **MEANINGFUL CITATION USAGE**:
  - Each citation must support a specific claim about that paper's contribution or approach
  - Cite papers when discussing their methods, findings, or limitations
  - Group related papers together and cite them when making comparative statements
  - Do NOT just list papers with citations at the end - integrate them into your arguments
  - Example: "Prior work has explored X~\cite{{paper1,paper2}}, but these approaches suffer from Y."
  - Follow loaded writer skills for compare-and-contrast methodology.

  {references}


title_refinement_prompt: |
  Great job! Now that there is a complete draft of the entire paper, let's refine each section again.
  Here is the current paper draft:
  {full_draft}

  Please provide a single, concise title that clearly reflects the paper's concept.
  Do not include any additional text, explanation, or formatting – output only the title.
